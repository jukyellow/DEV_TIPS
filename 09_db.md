# db

### 1. 방화벽 timeout 회피방법과 keepAlive 설정의 이해  
- 요약 : db-pool구현시, idle conn은 방화벽timeout에 의해 close될수 있는데, jdbc uri에 ENABLE=BROKEN를 설정하면,  
  Oracle 또는 서버 keepalive 설정이 되어있는경우, 방화벽timeout전 TCP/IP dummy 패킷으로 통신이 발생하여, 방화벽timeout을 피해갈수 있다.  
  그렇지 않으면 수동으로 heart-beat 쿼리를 발생시켜 방화벽 timeout을 회피한다.  

- 서버 KeepAlive 설정확인
> https://otsteam.tistory.com/44
```
<Sun Solaris>
# ndd/dev/tcp tcp_keepalive_interval
72000000 (2시간)
```

- Oracle KeepAlive 설정
> https://docs.oracle.com/cd/E11882_01/java.112/e16548/apxtblsh.htm#JJDBC28985
> https://community.oracle.com/thread/427688
> ENABLE=BROKEN

```
<서버 설정>
Enable Oracle Net DCD by setting SQLNET.EXPIRE_TIME=1 in the sqlnet.ora file on the server-side.
<jdbc 드라이버 uri 설정>
jdbc:oracle:thin:@(DESCRIPTION=(ENABLE=BROKEN)(ADDRESS=(PROTOCOL=tcp)(PORT=1521)(HOST=myhost))(CONNECT_DATA=(SID=orcl)))
```   



